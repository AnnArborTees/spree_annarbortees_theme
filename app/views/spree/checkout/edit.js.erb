<% steps = Array(params[:steps] || @order.state) %>

<% if @errors.present? %>
  alert(<%= @errors.join(', ').inspect %>);
<% end %>

<% if steps.empty? %>
  console.log("replaced NOTHING!!!");
<% else %>
  <% steps.each do |step| %>
    var step = $("#checkout_<%= step %>");

    step.replaceWith("<%=j render 'step', order: @order, step: step %>");
  <% end %>
<% end %>

try {
  $('.checkout-loading').each(function() {
    var spinner = $(this).data('spinner');
    if (spinner != null)
      spinner.stop();
  });
  $('.checkout-loading').removeClass('checkout-loading');
} catch(e) {
  console.error(e);
}

$('#checkout-summary-content').html("<%=j render partial: 'summary', locals: { order: @order } %>");
